<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Windows Media Playerのスキンを作る話 | クロワッサンは黒くない</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="概要Windows Media Player(以下、WMP)はスキンを何らかの手段で入手して、自分の好きな見た目に変更することができます。もちろん自分で作ることもでき、xml/javascriptを用いて比較的簡単にできるので、やっていきます。僕はn年前にiphon…1ph0n3の4sをモデルにしたものを作ったことがあり、今回はそれをip..1ph0n3の5sモデルで作りなおそうと思います。なぜ6">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows Media Playerのスキンを作る話">
<meta property="og:url" content="http://wassan128.github.io/blog/2016/08/26/index.html">
<meta property="og:site_name" content="クロワッサンは黒くない">
<meta property="og:description" content="概要Windows Media Player(以下、WMP)はスキンを何らかの手段で入手して、自分の好きな見た目に変更することができます。もちろん自分で作ることもでき、xml/javascriptを用いて比較的簡単にできるので、やっていきます。僕はn年前にiphon…1ph0n3の4sをモデルにしたものを作ったことがあり、今回はそれをip..1ph0n3の5sモデルで作りなおそうと思います。なぜ6">
<meta property="og:updated_time" content="2016-08-26T11:24:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Windows Media Playerのスキンを作る話">
<meta name="twitter:description" content="概要Windows Media Player(以下、WMP)はスキンを何らかの手段で入手して、自分の好きな見た目に変更することができます。もちろん自分で作ることもでき、xml/javascriptを用いて比較的簡単にできるので、やっていきます。僕はn年前にiphon…1ph0n3の4sをモデルにしたものを作ったことがあり、今回はそれをip..1ph0n3の5sモデルで作りなおそうと思います。なぜ6">
  
    <link rel="alternative" href="/blog/atom.xml" title="クロワッサンは黒くない" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css" type="text/css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">クロワッサンは黒くない</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/blog/" id="subtitle">とある高専生の備忘録的な何かになるかもしれない</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives/">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://wassan128.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Windows-Media-Playerのスキンを作る話" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2016/08/26/" class="article-date">
  <time datetime="2016-08-26T07:01:34.000Z" itemprop="datePublished">2016-08-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Windows Media Playerのスキンを作る話
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="概要">概要</h2><p>Windows Media Player(以下、WMP)はスキンを何らかの手段で入手して、自分の好きな見た目に変更することができます。もちろん自分で作ることもでき、xml/javascriptを用いて比較的簡単にできるので、やっていきます。僕はn年前にiphon…1ph0n3の4sをモデルにしたものを作ったことがあり、今回はそれをip..1ph0n3の5sモデルで作りなおそうと思います。なぜ6系ではないかというと僕の携帯が5sだからです(どうでもいい)。ちなみに作ったものはできればここでダウンロードできるようにしたいのですが、現在著作権利用(林檎社公式音楽再生アプリのスクショを使用しており、著作権利用ガイドラインを読んだ感じ大丈夫ではあると思うが念のため)に関する確認の途中なので、ダウンロードファイルの設置はそこら辺が明確になり次第ということにします。では、やっていきます。</p>
<a id="more"></a>
<h2 id="WMP_Skinについて">WMP Skinについて</h2><p>世の中の大半のスキン内部はおおよそ以下のようなファイル構成になって(いると思)います。</p>
<ul>
<li>wms(必須)</li>
<li>javascript(任意)</li>
<li>画像素材(任意)</li>
</ul>
<p>wmsファイルの中身はxmlで、この中で見た目を記述していきます。実際にスキンをリリースする際はこれらのファイルをまとめてzipに圧縮し、拡張子をwmzに変更すれば良いだけです。スキンを適用するときはwmzファイルをダブルクリックすると、ダウンロード・適用画面が出てくるのでポチポチやるとすぐ適用できます。<br>開発中はいちいちwmzにすると面倒なので、wmsファイルをダブルクリック、表示し、更新はWeb開発時のようにF5キーで行います。</p>
<h2 id="まずは画像素材の支度">まずは画像素材の支度</h2><p>1ph0n3(しつこい)の画像は適当にフリーのモックアップイメージを拾ってきます(もちろん自前でも可)。今回は<a href="http://www.actzero.jp/developer/report-5069.html" target="_blank" rel="external">こちら</a>を使わせていただくことにします。次に再生ボタンや次へボタンなどの各パーツをなんとかして調達します。今回は「前へ、次へ、再生、一時停止、プレイリスト表示、WMPライブラリへ戻る、シャッフル、リピート、シャッフル押下時、リピート押下時」を用意しました。ボタンだけでなく、シークバー、ボリュームバー用の画像なども個別に用意しないといけないので結構気合が入ります。<br>画像は背景を透過して描画させることができます。透過したい部分を何か単色で塗りつぶし、それを後で記述するxmlでclipping colorとして指定すれば良いので、とりあえず今回は#FFFF00(黄色)で透過したい部分を塗っておきます。</p>

<h2 id="wms(xml)記述">wms(xml)記述</h2><p>HTMLやCSSを書いたことのある人なら、なんとなくイメージが湧きやすいと思いますが、ここはただただ書くだけです。予め意味を持たされているタグを利用しつつ、今回は以下の様な記述を行いました。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">theme</span> <span class="attribute">title</span>=<span class="value">"1ph0n3"</span> <span class="attribute">copyright</span>=<span class="value">"@wassan128"</span> <span class="attribute">author</span>=<span class="value">"wassan128"</span> <span class="attribute">scriptfile</span>=<span class="value">"main.js"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">view</span> <span class="attribute">backgroundimage</span>=<span class="value">"bg.png"</span> <span class="attribute">clippingColor</span>=<span class="value">"#FFFF00"</span> <span class="attribute">titlebar</span>=<span class="value">"false"</span> <span class="attribute">resizable</span>=<span class="value">"false"</span> <span class="attribute">onload</span>=<span class="value">"onload()"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">player</span> <span class="attribute">openstatechange</span>=<span class="value">"meta_update()"</span> <span class="attribute">currentitemchange</span>=<span class="value">"meta_update()"</span> <span class="attribute">currentPlaylistChange</span>=<span class="value">"meta_update()"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">returnbutton</span> <span class="attribute">top</span>=<span class="value">"111"</span> <span class="attribute">left</span>=<span class="value">"36"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"library.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">button</span> <span class="attribute">top</span>=<span class="value">"111"</span> <span class="attribute">left</span>=<span class="value">"235"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"list.png"</span></span><br><span class="line">			<span class="attribute">onclick</span>=<span class="value">"Jscript:list.visible=!list.visible"</span></span><br><span class="line">			<span class="attribute">uptooltip</span>=<span class="value">"playlist"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">text</span> <span class="attribute">top</span>=<span class="value">"117"</span> <span class="attribute">left</span>=<span class="value">"132"</span> <span class="attribute">id</span>=<span class="value">"pl_numer"</span></span><br><span class="line">			<span class="attribute">foregroundcolor</span>=<span class="value">"#666666"</span></span><br><span class="line">			<span class="attribute">fontStyle</span>=<span class="value">"bold"</span></span><br><span class="line">			<span class="attribute">fontFace</span>=<span class="value">"メイリオ"</span></span><br><span class="line">			<span class="attribute">fontSize</span>=<span class="value">"5"</span></span><br><span class="line">			<span class="attribute">value</span>=<span class="value">"000"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">text</span> <span class="attribute">top</span>=<span class="value">"117"</span> <span class="attribute">left</span>=<span class="value">"160"</span> <span class="attribute">id</span>=<span class="value">"pl_denom"</span></span><br><span class="line">			<span class="attribute">foregroundcolor</span>=<span class="value">"#666666"</span></span><br><span class="line">			<span class="attribute">fontStyle</span>=<span class="value">"bold"</span></span><br><span class="line">			<span class="attribute">fontFace</span>=<span class="value">"メイリオ"</span></span><br><span class="line">			<span class="attribute">fontSize</span>=<span class="value">"5"</span></span><br><span class="line">			<span class="attribute">value</span>=<span class="value">"000"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">playbutton</span> <span class="attribute">top</span>=<span class="value">"435"</span> <span class="attribute">left</span>=<span class="value">"120"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"play.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">pausebutton</span> <span class="attribute">top</span>=<span class="value">"435"</span> <span class="attribute">left</span>=<span class="value">"120"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"pause.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">			<span class="attribute">onClick</span>=<span class="value">"player.controls.pause();"</span></span><br><span class="line">			<span class="attribute">visible</span>=<span class="value">"wmpenabled:player.controls.pause"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">prevbutton</span> <span class="attribute">top</span>=<span class="value">"435"</span> <span class="attribute">left</span>=<span class="value">"58"</span></span><br><span class="line"> 			<span class="attribute">image</span>=<span class="value">"prev.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">nextbutton</span> <span class="attribute">top</span>=<span class="value">"435"</span> <span class="attribute">left</span>=<span class="value">"183"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"next.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">repeatbutton</span> <span class="attribute">top</span>=<span class="value">"482"</span> <span class="attribute">left</span>=<span class="value">"38"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"repeat.png"</span></span><br><span class="line">			<span class="attribute">downimage</span>=<span class="value">"repeated.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">shufflebutton</span> <span class="attribute">top</span>=<span class="value">"482"</span> <span class="attribute">left</span>=<span class="value">"200"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"shuffle.png"</span></span><br><span class="line">			<span class="attribute">downimage</span>=<span class="value">"shuffled.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">minimizebutton</span> <span class="attribute">top</span>=<span class="value">"518"</span> <span class="attribute">left</span>=<span class="value">"120"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"minimize.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">closebutton</span> <span class="attribute">top</span>=<span class="value">"0"</span> <span class="attribute">left</span>=<span class="value">"192"</span></span><br><span class="line">			<span class="attribute">image</span>=<span class="value">"close.png"</span></span><br><span class="line">			<span class="attribute">cursor</span>=<span class="value">"hand"</span></span><br><span class="line">			<span class="attribute">transparencycolor</span>=<span class="value">"#FFFF00"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">tracknametext</span> <span class="attribute">top</span>=<span class="value">"393"</span> <span class="attribute">left</span>=<span class="value">"40"</span> <span class="attribute">id</span>=<span class="value">"trackname"</span></span><br><span class="line">			<span class="attribute">width</span>=<span class="value">"220"</span></span><br><span class="line">			<span class="attribute">fontsize</span>=<span class="value">"7"</span></span><br><span class="line">			<span class="attribute">foregroundcolor</span>=<span class="value">"black"</span></span><br><span class="line">			<span class="attribute">backgroundcolor</span>=<span class="value">"transparent"</span></span><br><span class="line">			<span class="attribute">scrolling</span>=<span class="value">"false"</span></span><br><span class="line">			<span class="attribute">scrollingamount</span>=<span class="value">"3"</span></span><br><span class="line">			<span class="attribute">justification</span>=<span class="value">"center"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">text</span> <span class="attribute">top</span>=<span class="value">"415"</span> <span class="attribute">left</span>=<span class="value">"40"</span> <span class="attribute">id</span>=<span class="value">"author_text"</span></span><br><span class="line">			<span class="attribute">width</span>=<span class="value">"220"</span></span><br><span class="line">			<span class="attribute">fontsize</span>=<span class="value">"5"</span></span><br><span class="line">			<span class="attribute">foregroundColor</span>=<span class="value">"darkslategray"</span></span><br><span class="line">			<span class="attribute">fontStyle</span>=<span class="value">"regular"</span></span><br><span class="line">			<span class="attribute">tabStop</span>=<span class="value">"false"</span></span><br><span class="line">			<span class="attribute">justification</span>=<span class="value">"center"</span></span><br><span class="line">			<span class="attribute">value</span>=<span class="value">"jscript:player.currentMedia.getItemInfo('Author');"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">volumeslider</span> <span class="attribute">top</span>=<span class="value">"465"</span> <span class="attribute">left</span>=<span class="value">"70"</span></span><br><span class="line">			<span class="attribute">transparencycolor</span>=<span class="value">"#FFFF00"</span></span><br><span class="line">			<span class="attribute">foregroundimage</span>=<span class="value">"vol_fore.png"</span></span><br><span class="line">			<span class="attribute">backgroundimage</span>=<span class="value">"vol_back.png"</span></span><br><span class="line">			<span class="attribute">thumbimage</span>=<span class="value">"vol_ball.png"</span></span><br><span class="line">			<span class="attribute">bordersize</span>=<span class="value">"7"</span></span><br><span class="line">			<span class="attribute">direction</span>=<span class="value">"horizontal"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">slider</span> <span class="attribute">top</span>=<span class="value">"378"</span> <span class="attribute">left</span>=<span class="value">"79"</span></span><br><span class="line">			<span class="attribute">width</span>=<span class="value">"140"</span></span><br><span class="line">			<span class="attribute">bordersize</span>=<span class="value">"1"</span></span><br><span class="line">			<span class="attribute">transparencycolor</span>=<span class="value">"#FFFF00"</span></span><br><span class="line">			<span class="attribute">slide</span>=<span class="value">"false"</span></span><br><span class="line">			<span class="attribute">foregroundimage</span>=<span class="value">"seek_fore.png"</span></span><br><span class="line">			<span class="attribute">backgroundimage</span>=<span class="value">"seek_back.png"</span></span><br><span class="line">			<span class="attribute">thumbimage</span>=<span class="value">"seek_ball.png"</span></span><br><span class="line">			<span class="attribute">direction</span>=<span class="value">"horizontal"</span></span><br><span class="line">			<span class="attribute">min</span>=<span class="value">"0"</span></span><br><span class="line">			<span class="attribute">max</span>=<span class="value">"wmpprop:player.currentmedia.duration"</span></span><br><span class="line">			<span class="attribute">ondragend</span>=<span class="value">"player.controls.currentposition=value;"</span></span><br><span class="line">			<span class="attribute">value</span>=<span class="value">"wmpprop:player.controls.currentposition"</span></span><br><span class="line">			<span class="attribute">tooltip</span>=<span class="value">"seek"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">text</span> <span class="attribute">top</span>=<span class="value">"379"</span> <span class="attribute">left</span>=<span class="value">"40"</span></span><br><span class="line">			<span class="attribute">width</span>=<span class="value">"30"</span></span><br><span class="line">			<span class="attribute">fontFace</span>=<span class="value">"メイリオ"</span></span><br><span class="line">			<span class="attribute">fontsize</span>=<span class="value">"5"</span></span><br><span class="line">			<span class="attribute">foregroundcolor</span>=<span class="value">"dimgray"</span></span><br><span class="line">			<span class="attribute">value</span>=<span class="value">"wmpprop:player.controls.currentPositionString"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">text</span> <span class="attribute">top</span>=<span class="value">"379"</span> <span class="attribute">left</span>=<span class="value">"230"</span></span><br><span class="line">			<span class="attribute">width</span>=<span class="value">"30"</span></span><br><span class="line">			<span class="attribute">fontSize</span>=<span class="value">"5"</span></span><br><span class="line">			<span class="attribute">fontFace</span>=<span class="value">"メイリオ"</span></span><br><span class="line">			<span class="attribute">foregroundcolor</span>=<span class="value">"dimgray"</span></span><br><span class="line">			<span class="attribute">value</span>=<span class="value">"wmpprop:player.currentMedia.durationString"</span></span><br><span class="line">		/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">subview</span> <span class="attribute">id</span>=<span class="value">"list"</span> <span class="attribute">visible</span>=<span class="value">"false"</span> <span class="attribute">top</span>=<span class="value">"140"</span> <span class="attribute">left</span>=<span class="value">"35"</span> <span class="attribute">backgroundcolor</span>=<span class="value">"none"</span> <span class="attribute">onload</span>=<span class="value">"meta_update()"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">playlist</span> <span class="attribute">top</span>=<span class="value">"0"</span> <span class="attribute">left</span>=<span class="value">"0"</span></span><br><span class="line">				<span class="attribute">width</span>=<span class="value">"232"</span></span><br><span class="line">				<span class="attribute">height</span>=<span class="value">"232"</span></span><br><span class="line">				<span class="attribute">itemPlayingColor</span>=<span class="value">"whitesmoke"</span></span><br><span class="line">				<span class="attribute">itemPlayingBackgroundColor</span>=<span class="value">"gray"</span></span><br><span class="line">				<span class="attribute">disableditemcolor</span>=<span class="value">"#808080"</span></span><br><span class="line">				<span class="attribute">foregroundcolor</span>=<span class="value">"darkslategray"</span></span><br><span class="line">				<span class="attribute">backgroundcolor</span>=<span class="value">"whitesmoke"</span></span><br><span class="line">				<span class="attribute">dropdownvisible</span>=<span class="value">"false"</span></span><br><span class="line">				<span class="attribute">columnsvisible</span>=<span class="value">"false"</span></span><br><span class="line">			/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">subview</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">subview</span> <span class="attribute">id</span>=<span class="value">"album_art_work"</span> <span class="attribute">visible</span>=<span class="value">"true"</span> <span class="attribute">top</span>=<span class="value">"140"</span> <span class="attribute">left</span>=<span class="value">"35"</span> <span class="attribute">backgroundImage</span>=<span class="value">"WMPImage_AlbumArtLarge"</span> <span class="attribute">width</span>=<span class="value">"232"</span> <span class="attribute">height</span>=<span class="value">"232"</span> <span class="attribute">resizeBackgroundImage</span>=<span class="value">"true"</span> <span class="attribute">passThrough</span>=<span class="value">"true"</span> <span class="attribute">justification</span>=<span class="value">"center"</span>&gt;</span><span class="tag">&lt;/<span class="title">subview</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">theme</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="&lt;theme&gt;:">&lt;theme&gt;:</h4><p>テーマ全般に関するタグです。スキンのタイトル(スキンセレクターで表示される名前)、著作者表示、製作者に加えてJavaScriptのファイルを指定します。複数ある場合は;(セミコロン)で区切るようです。</p>
<h4 id="&lt;view&gt;:">&lt;view&gt;:</h4><p>htmlでいうbodyタグといったところでしょうか。背景画像やその他表示に関する属性を記述できます。clipping colorで指定した色が透過されて描画されます。</p>
<h4 id="&lt;subview&gt;:">&lt;subview&gt;:</h4><p>htmlでいうdiv(ここでhtml5信者に刺される)的なタグということにしておきましょう。</p>
<h4 id="&lt;player&gt;:">&lt;player&gt;:</h4><p>プレイヤーのイベントハンドラをここで登録しました。各イベントの発生毎にmeta_upload関数が呼び出され、メタ情報が更新・再描画されます。</p>
<h4 id="&lt;returnbutton&gt;:">&lt;returnbutton&gt;:</h4><p>WMPのライブラリ(何を言っているかわからないかもしれないが、恐らくほとんどの人が一度は見たことがあるはず)を表示するボタンを指定しています。</p>
<h4 id="&lt;button&gt;:">&lt;button&gt;:</h4><p>ボタンです。今回はプレイリストを表示するようにonclickで意味付けをしたものが書いてあります。</p>
<h4 id="&lt;text&gt;:">&lt;text&gt;:</h4><p>テキストです。idを指定して、javascriptで書き換えているものがいくつかあります。</p>
<h4 id="&lt;playbutton&gt;:">&lt;playbutton&gt;:</h4><p>三角の再生開始ボタンです。</p>
<h4 id="&lt;pausebutton&gt;:">&lt;pausebutton&gt;:</h4><p>一時停止ボタンです。</p>
<h4 id="&lt;prevbutton&gt;:">&lt;prevbutton&gt;:</h4><p>曲を早戻ししそうな見た目をしていますが、プレイリストのひとつ前の曲へ移動するボタンです。</p>
<h4 id="&lt;next&gt;:">&lt;next&gt;:</h4><p>prevbuttonの逆をするボタンです。</p>
<h4 id="&lt;repeat&gt;:">&lt;repeat&gt;:</h4><p>プレイリスト内の曲をリピート再生するか指定するボタンです。</p>
<h4 id="&lt;shuffle&gt;:">&lt;shuffle&gt;:</h4><p>プレイリスト内の曲を順番通りでなくランダムに再生するか指定するボタンです。</p>
<h4 id="&lt;minimizebutton&gt;:">&lt;minimizebutton&gt;:</h4><p>スキン表示を最小化でタスクバーに隠すボタンです。</p>
<h4 id="&lt;closebutton&gt;:">&lt;closebutton&gt;:</h4><p>閉じるボタンです。</p>
<h4 id="&lt;tracknametext&gt;:">&lt;tracknametext&gt;:</h4><p>再生中の曲名を表示します。</p>
<h4 id="&lt;volumeslider&gt;:">&lt;volumeslider&gt;:</h4><p>実際に動かす球(?)とボリューム出てます色バーと出てません色バーを画像で指定すると良い感じにボリュームバーが出来上がります。</p>
<h4 id="&lt;slider&gt;:">&lt;slider&gt;:</h4><p>ボリュームバーのように3つ画像を用意・指定するとシークバーが描画されます。</p>
<h4 id="&lt;playlist&gt;:">&lt;playlist&gt;:</h4><p>プレイリストに入っている曲を描画する領域です。</p>
<p>その他のタグや各タグに指定できる属性は<a href="https://msdn.microsoft.com/ja-jp/library/cc364944.aspx" target="_blank" rel="external">スキンプログラミングリファレンス</a>で確認できます。凝りたい方はこちらを一読されると良いと思います。</p>
<h2 id="JavaScriptの記述">JavaScriptの記述</h2><p>JavaScriptでは再生中の曲が変わった時などに、メタ情報(アルバムアートワーク、作曲者、曲名…)の更新を行います。今回のコードは以下の様な感じです。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* When start up skin */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onload</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	meta_update();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Control about meta data(playlist, track) */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">meta_update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// related playlist</span></span><br><span class="line">	pl_denom.value = player.currentPlaylist.count;</span><br><span class="line">	pl_numer.value = getIdx();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// update album art work</span></span><br><span class="line">	album_art_work.backgroundImage = <span class="string">"WMPImage_AlbumArtlarge"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// update track author name text</span></span><br><span class="line">	author_text.value = player.currentMedia.getItemInfo(<span class="string">"author"</span>);</span><br><span class="line">	<span class="keyword">if</span> (author_text.value == <span class="string">""</span>) &#123;</span><br><span class="line">		author_text.value = <span class="string">"undefined"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Current media index */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getIdx</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> pl = player.currentPlaylist;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; pl.count; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (pl.item(i).name == trackname.value) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>meta_update関数はメタ情報を更新して、上のwmsファイルで指定したidの要素を書き換える処理をしています。getIdx関数はプレイリストの何番目の曲を再生しているのかというのを表示するために、今何番目が流れているのかを調べる関数です(リファレンスをぱっと見た感じそういうメンバをcurrentPlaylistオブジェクトに見つけられなかったので適当に書いたけど、本当にないのかよくわからず…)。これをwms内でイベントハンドラに登録する形で記述してあるのがわかると思います。重要なのは&lt;player&gt;に登録してある、currentItemChangeイベント等でしょう。これは曲が変わるときなどに発生するイベント(説明が雑)なので、ここでメタ情報を更新しておけば、良い感じなります。</p>
<h2 id="できたもの">できたもの</h2><p><blockquote class="twitter-tweet tw-align-center" data-lang="ja"><p lang="ja" dir="ltr">windows media playerのスキン久々に作った <a href="https://t.co/c7zoSuJuh3" target="_blank" rel="external">pic.twitter.com/c7zoSuJuh3</a></p>&mdash; わっさん (@wassan128) <a href="https://twitter.com/wassan128/status/769130025765306368" target="_blank" rel="external">2016年8月26日</a></blockquote></p>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="おわりに">おわりに</h2><p>昔作った時も思いましたが、結構情報が少ない印象です(リファレンス見ればだいたい解決しますが)。n年前に制作した時はどうやって情報を集めたかあんまり覚えていませんが、個人的には実際にあるスキンを解凍してソースを見てみるというのが一番手っ取り早いと思います(もちろん、作者がそれを許諾しているスキンで)。あとはcss書いたことがあるとfontSizeなどの属性が雰囲気でわかるので、書きやすいと思います。JavaScript部分もあんまり最初リファレンス読まずに書いていたので手探り状態で、CurrentItemChangeにたどり着くまで結構かかりました。<br>冒頭でも書いた当スキンの公開についてですが、<a href="http://www.apple.com/jp/legal/trademark/guidelinesfor3rdparties.html" target="_blank" rel="external">こちら</a>の著作権利用に関するガイドラインを見た限りは問題ないような気がするのですが、はっきりわからないので現在問い合わせメールの返答待ちをしています。はっきりし次第公開できれば良いなと思っています。ソースの方は問題ないと思うので、スキン作りの参考になれば幸いです。</p>
<h2 id="参考資料">参考資料</h2><ul>
<li><a href="http://www.actzero.jp/developer/report-5069.html" target="_blank" rel="external">プレゼン資料にも使える！iPhone5s、iPhone5cの無料イラスト素材(http://www.actzero.jp/developer/report-5069.html)</a></li>
<li><a href="https://msdn.microsoft.com/ja-jp/library/cc364944.aspx" target="_blank" rel="external">スキンプログラミングリファレンス(https://msdn.microsoft.com/ja-jp/library/cc364944.aspx)</a></li>
<li><a href="http://niyodiary.cocolog-nifty.com/blog/2012/09/windows-media-p.html" target="_blank" rel="external">実用的なWindows Media Playerスキン - niyoな日記(http://niyodiary.cocolog-nifty.com/blog/2012/09/windows-media-p.html)</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd564034.aspx" target="_blank" rel="external">Player Object(https://msdn.microsoft.com/en-us/library/windows/desktop/dd564034.aspx)</a></li>
<li><a href="http://delphi.ktop.com.tw/board.php?tid=36662" target="_blank" rel="external">自製 Windows Media Player 面版(http://delphi.ktop.com.tw/board.php?tid=36662)</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wassan128.github.io/blog/2016/08/26/" data-id="ciwkocmkv000k1owv00akzrco" class="article-share-link">Share</a>
      
        <a href="http://wassan128.github.io/blog/2016/08/26/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/windows-media-player/">windows media player</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2016/12/04/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          KOSENセキュリティ・コンテスト2016に参加した話
        
      </div>
    </a>
  
  
    <a href="/blog/2016/08/24/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">VirusTotalでのファイルスキャン結果をRaspberry Piに喋ってもらう話</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Node-js/">Node.js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/ctf/">ctf</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/disqus/">disqus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/git/">git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/hexo/">hexo</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/javascript/">javascript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/malware/">malware</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/math/">math</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/misc/">misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/python/">python</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/raspberry-pi/">raspberry pi</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/twitter/">twitter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/windows-media-player/">windows media player</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/blog/tags/ctf/" style="font-size: 16.67px;">ctf</a> <a href="/blog/tags/disqus/" style="font-size: 10px;">disqus</a> <a href="/blog/tags/git/" style="font-size: 13.33px;">git</a> <a href="/blog/tags/hexo/" style="font-size: 16.67px;">hexo</a> <a href="/blog/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/blog/tags/malware/" style="font-size: 10px;">malware</a> <a href="/blog/tags/math/" style="font-size: 10px;">math</a> <a href="/blog/tags/misc/" style="font-size: 10px;">misc</a> <a href="/blog/tags/python/" style="font-size: 20px;">python</a> <a href="/blog/tags/raspberry-pi/" style="font-size: 10px;">raspberry pi</a> <a href="/blog/tags/twitter/" style="font-size: 10px;">twitter</a> <a href="/blog/tags/windows-media-player/" style="font-size: 10px;">windows media player</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/12/">December 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/08/">August 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/06/">June 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/05/">May 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/09/">September 2015</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2016/12/11/">SECCON 2016 online CTFで解けた問題とかの話</a>
          </li>
        
          <li>
            <a href="/blog/2016/12/04/">KOSENセキュリティ・コンテスト2016に参加した話</a>
          </li>
        
          <li>
            <a href="/blog/2016/08/26/">Windows Media Playerのスキンを作る話</a>
          </li>
        
          <li>
            <a href="/blog/2016/08/24/">VirusTotalでのファイルスキャン結果をRaspberry Piに喋ってもらう話</a>
          </li>
        
          <li>
            <a href="/blog/2016/08/18/">x64マシンでpy2exeを使ってx86バイナリを吐き出した話</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 wassan128<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives/" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'wassan128';
  
  var disqus_url = 'http://wassan128.github.io/blog/2016/08/26/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/blog/js/script.js" type="text/javascript"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>